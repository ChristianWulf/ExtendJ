apply plugin: JastAddPlugin

jastaddj {
	module = "java7 backend"
	javaVersion = "Java SE 7"

	astPackage = "AST"
	sourceDir = "src"
	toolsDir = "tools"
	resourceDir = "${sourceDir}/res"

	binDir = "ant-bin"
	tmpDir = "${sourceDir}/tmp"
	genDir = "${sourceDir}/gen"
}

JastAddPlugin.modules {
	load("java4", "frontend.module")
	load("java4", "backend.module")
	load("java5", "frontend.module")
	load("java5", "backend.module")
	load("java6", "frontend.module")
	load("java6", "backend.module")
	load("java7", "frontend.module")
	load("java7", "backend.module")
}

apply plugin: JastAddJPlugin

task build(dependsOn: ['gen','resources']) << {
	ant.mkdir(dir: file(project.jastaddj.binDir))
	ant.javac(destdir: file(project.jastaddj.binDir), debug: true, nowarn: true,
		source: '1.6', target: '1.6',
		includeAntRuntime: false) {
		classpath() {
			pathelement(path: file("${project.jastaddj.toolsDir}/ant-1.9.1.jar"))
		}
		src(path: "${project.jastaddj.sourceDir}/frontend")
		src(path: "${project.jastaddj.sourceDir}/backend")
		src(path: file(genDir))
	}
}

